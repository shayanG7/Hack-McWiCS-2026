<!DOCTYPE html>
<html lang="en">

  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">

    <title>Group Name</title>

    <!-- Bootstrap core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Additional CSS Files -->
    <link rel="stylesheet" href="assets/css/fontawesome.css">
    <link rel="stylesheet" href="assets/css/templatemo-lugx-gaming.css">
    <link rel="stylesheet" href="assets/css/owl.css">
    <link rel="stylesheet" href="assets/css/animate.css">
    <link rel="stylesheet"href="https://unpkg.com/swiper@7/swiper-bundle.min.css"/>
<!--

https://templatemo.com/tm-589-lugx-gaming

-->
  </head>

<body>

  <!-- ***** Preloader Start ***** -->
  <div id="js-preloader" class="js-preloader">
    <div class="preloader-inner">
      <span class="dot"></span>
      <div class="dots">
        <span></span>
        <span></span>
        <span></span>
      </div>
    </div>
  </div>
  <!-- ***** Preloader End ***** -->

  <!-- ***** Header Area Start ***** -->
  <header class="header-area header-sticky">
    <div class="container">
        <div class="row">
            <div class="col-12">
                <nav class="main-nav">
                    <!-- ***** Logo Start ***** -->
                    <!-- ***** Logo End ***** -->
                    <!-- ***** Menu Start ***** -->
                    <ul class="nav">
                      <li><a href="index.html">Home</a></li>
                      <li><a href="account.html">Account</a></li>
                  </ul>   
                    <a class='menu-trigger'>
                        <span>Menu</span>
                    </a>
                    <!-- ***** Menu End ***** -->
                </nav>
            </div>
        </div>
    </div>
  </header>
  <!-- ***** Header Area End ***** -->

  <div class="page-heading header-text">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <h3 id="group-title">News Group Name</h3>
          <p id="group-tags" class="text-white-50 mb-0"></p>
        </div>
      </div>
    </div>
  </div>

  <div class="single-product section">
    <div class="container">
      <form class="row" action="#">
        <div class="col-lg-12">
          <label for="share-thoughts" id="group-prompt" class="form-label d-block mb-2 pb-2 border-bottom">Pondering inspirational talking points...</label>
          <textarea
            id="share-thoughts"
            name="share_thoughts"
            class="form-control"
            rows="5"
            maxlength="500"
            placeholder="Write your thoughts here..."
          ></textarea>
          <div id="share-thoughts-count" class="text-muted small mt-2" aria-live="polite">0/500</div>
          <button type="submit" class="main-button">Post</button>
        </div>
      </form>
    </div>
  </div>

  <section class="more-info">
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <div class="section-heading mb-2">
            <h6>Community</h6>
            <h3>User Posts</h3>
          </div>
          <div
            id="posts-list"
            class="border rounded p-3 mt-0"
            style="max-height: 360px; overflow-y: auto;"
            aria-live="polite"
          >
            <div class="p-3 mb-3 rounded">No posts yet. Be the first to share!</div>
          </div>
          <button type="button" id="clear-posts" class="clear-posts-button mt-3">Clear Posts</button>
        </div>
      </div>
    </div>
  </section>

  <footer>
    <div class="container">
      <div class="row">
        <div class="col-lg-12">
          <p>Copyright Â© 2026 Notable. All Rights Reserved.</p>
    </div>
  </footer>

  <!-- Scripts -->
  <!-- Bootstrap core JavaScript -->
  <script src="vendor/jquery/jquery.min.js"></script>
  <script src="vendor/bootstrap/js/bootstrap.min.js"></script>
  <script src="assets/js/isotope.min.js"></script>
  <script src="assets/js/owl-carousel.js"></script>
  <script src="assets/js/counter.js"></script>
  <script src="assets/js/custom.js"></script>
  <!-- Char Counter -->
  <script>
    document.addEventListener("DOMContentLoaded", function () {
      var textarea = document.getElementById("share-thoughts");
      var counter = document.getElementById("share-thoughts-count");
      var postsList = document.getElementById("posts-list");
      var form = document.querySelector(".single-product form");
      var clearButton = document.getElementById("clear-posts");
      var titleEl = document.getElementById("group-title");
      var tagsEl = document.getElementById("group-tags");
      var promptEl = document.getElementById("group-prompt");

      var params = new URLSearchParams(window.location.search);
      var groupId = params.get("groupId") || "";
      var storageKey = groupId ? "user_posts:" + groupId : "user_posts";

      var getGroups = function () {
        try {
          var raw = localStorage.getItem("notable_groups");
          if (!raw) return [];
          return JSON.parse(raw) || [];
        } catch (error) {
          return [];
        }
      };

      var applyGroupInfo = function (group) {
        if (!group) return;
        if (titleEl) titleEl.textContent = group.title || "News Group";
        if (tagsEl) tagsEl.textContent = group.tags || "";
        if (promptEl) {
          promptEl.textContent = group.prompt || "Share a thought with your group.";
        }
        if (group.title) document.title = group.title;
      };

      var setPromptText = function (text) {
        if (promptEl && text) {
          promptEl.textContent = text;
        }
      };

      var normalizeCategory = function (rawTags) {
        if (!rawTags) return "";
        return rawTags.replace(/#/g, " ").trim();
      };

      var groups = getGroups();
      var match = null;

      if (groupId) {
        match = groups.find(function (g) {
          return g && g.id === groupId;
        });
        applyGroupInfo(match);
      }

      var promptCacheKey = groupId ? "group_prompt:" + groupId : "group_prompt:default";
      var cachedPrompt = localStorage.getItem(promptCacheKey);
      if (cachedPrompt) {
        setPromptText(cachedPrompt);
      } else {
        var groupName = (match && match.title) ? match.title : "News Group";
        var category = normalizeCategory(match && match.tags ? match.tags : "") || "General";

        fetch("http://localhost:5000/api/weekly-prompt?groupName=" + encodeURIComponent(groupName) + "&category=" + encodeURIComponent(category))
          .then(function (res) {
            if (!res.ok) throw new Error("Prompt request failed");
            return res.json();
          })
          .then(function (data) {
            if (!data || !data.prompt) return;
            setPromptText(data.prompt);
            localStorage.setItem(promptCacheKey, data.prompt);

            if (match && match.id) {
              var updated = groups.map(function (g) {
                if (g && g.id === match.id) {
                  return Object.assign({}, g, { prompt: data.prompt });
                }
                return g;
              });
              localStorage.setItem("notable_groups", JSON.stringify(updated));
            }
          })
          .catch(function () {
            return;
          });
      }

      if (!textarea || !counter) {
        return;
      }

      var maxLength = textarea.maxLength || 500;

      var updateCount = function () {
        var currentLength = textarea.value.length;
        counter.textContent = currentLength + "/" + maxLength;
      };

      var createPostElement = function (text) {
        var post = document.createElement("div");
        post.className = "p-3 mb-3 border rounded";
        post.textContent = text;
        return post;
      };

      var createPlaceholder = function () {
        var placeholder = document.createElement("div");
        placeholder.className = "p-3 mb-3 rounded";
        placeholder.textContent = "No posts yet. Be the first to share!";
        return placeholder;
      };

      var loadPosts = function () {
        if (!postsList) {
          return;
        }

        var saved = localStorage.getItem(storageKey);
        if (!saved) {
          return;
        }

        var posts = [];
        try {
          posts = JSON.parse(saved) || [];
        } catch (error) {
          return;
        }

        if (!posts.length) {
          return;
        }

        postsList.innerHTML = "";
        posts.forEach(function (text) {
          postsList.appendChild(createPostElement(text));
        });
      };

      var savePosts = function (posts) {
        localStorage.setItem(storageKey, JSON.stringify(posts));
      };

      var getPostsFromList = function () {
        if (!postsList) {
          return [];
        }

        var items = postsList.querySelectorAll(":scope > .p-3");
        return Array.prototype.map.call(items, function (item) {
          return item.textContent;
        });
      };

      var addPost = function () {
        if (!postsList) {
          return;
        }

        var value = textarea.value.trim();

        if (!value) {
          return;
        }

        var placeholder = postsList.querySelector(":scope > .p-3");
        if (placeholder && placeholder.textContent.indexOf("No posts yet") !== -1) {
          placeholder.remove();
        }

        postsList.appendChild(createPostElement(value));
        postsList.scrollTop = postsList.scrollHeight;
        savePosts(getPostsFromList());

        textarea.value = "";
        updateCount();
      };

      var clearPosts = function () {
        if (!postsList) {
          return;
        }

        postsList.innerHTML = "";
        postsList.appendChild(createPlaceholder());
        localStorage.removeItem(storageKey);
      };

      updateCount();
      textarea.addEventListener("input", updateCount);
      loadPosts();

      if (form) {
        form.addEventListener("submit", function (event) {
          event.preventDefault();
          addPost();
        });
      }

      if (clearButton) {
        clearButton.addEventListener("click", clearPosts);
      }
    });
  </script>

  </body>
</html>